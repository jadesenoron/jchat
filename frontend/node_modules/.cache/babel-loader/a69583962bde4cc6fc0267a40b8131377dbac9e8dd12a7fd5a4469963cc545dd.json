{"ast":null,"code":"import _objectSpread from\"/workspaces/jchat/frontend/node_modules/@babel/runtime/helpers/esm/objectSpread2.js\";import _regeneratorRuntime from\"/workspaces/jchat/frontend/node_modules/@babel/runtime/helpers/esm/regeneratorRuntime.js\";import _toConsumableArray from\"/workspaces/jchat/frontend/node_modules/@babel/runtime/helpers/esm/toConsumableArray.js\";import _asyncToGenerator from\"/workspaces/jchat/frontend/node_modules/@babel/runtime/helpers/esm/asyncToGenerator.js\";import _slicedToArray from\"/workspaces/jchat/frontend/node_modules/@babel/runtime/helpers/esm/slicedToArray.js\";import{useState,useEffect}from'react';import ChatMessageContent from\"./ChatMessageContent\";import{getChatData,getChatConversation,getUserById,getUserByUsername}from'../../api';import Swal from'sweetalert2';import{jsx as _jsx}from\"react/jsx-runtime\";import{Fragment as _Fragment}from\"react/jsx-runtime\";export default function ChatConversation(_ref){var chatid=_ref.chatid,userid=_ref.userid,username=_ref.username;var _useState=useState(null),_useState2=_slicedToArray(_useState,2),chat_id=_useState2[0],setChatId=_useState2[1];var _useState3=useState([]),_useState4=_slicedToArray(_useState3,2),data=_useState4[0],setData=_useState4[1];var _useState5=useState(null),_useState6=_slicedToArray(_useState5,2),myUser=_useState6[0],setMyUser=_useState6[1];var _useState7=useState(null),_useState8=_slicedToArray(_useState7,2),otherUser=_useState8[0],setOtherUser=_useState8[1];// const [messagesEnd, setMessagesEnd] = useState()\nvar handleOpenPhotos=function handleOpenPhotos(photo,i,photos){console.log(photo,i,photos);console.log(photos);Swal.fire({width:'100%',height:'100%',background:'#030821be',html:\"<img src=\\\"http://\".concat(window.location.hostname,\":\").concat(process.env.NODE_ENV==='development'?'3080':window.location.port).concat(photo,\"\\\" class=\\\"img-thumbnail img-fluid\\\" />\")});};useEffect(function(){if(myUser===null&&userid){getUserById(userid).then(function(resp){return new Promise(function(res,rej){return resp.data?res(resp.data):rej('Invalid chat data');});}).then(function(myuserinfo){return setMyUser(myuserinfo);}).catch(function(err){setMyUser(null);console.log(err);});}if(otherUser===null&&userid){if(chatid){getChatData(userid).then(function(resp){return new Promise(function(res){return res(resp.data);});}).then(function(_ref2){var success=_ref2.success,error=_ref2.error;return new Promise(function(res,rej){return success?res(success.data.filter(function(v){return v._id.toString()===chatid;}).pop()):rej(error);});}).then(function(chatdata){return chatdata?getUserById(chatdata.users.map(function(v){return v._id;}).filter(function(uid){return uid!==userid;}).pop()||'').then(function(resp){return new Promise(function(res){return res(resp.data);});}):function(){throw new Error('Invalid chat data');}();}).then(function(userinfo){return setOtherUser(userinfo);}).catch(function(err){setOtherUser(null);console.log(err);});}else if(username){getUserByUsername(username).then(function(resp){return new Promise(function(res){return res(resp.data);});}).then(function(userinfo){return setOtherUser(userinfo);}).catch(function(err){setOtherUser(null);console.log(err);});}else{setOtherUser(null);}}},[chatid,userid,username,myUser,otherUser]);useEffect(function(){if(chat_id===null&&chatid&&userid&&myUser!==null&&otherUser!==null){getChatData(userid).then(function(resp){return new Promise(function(res){return res(resp.data);});}).then(function(_ref3){var success=_ref3.success,error=_ref3.error;return new Promise(function(res,rej){return success?res(success.data.filter(function(v){return v._id.toString()===chatid;}).length===1):rej(error);});}).then(function(isValid){return isValid?setChatId(chatid):setChatId(null);}).catch(function(error){setChatId(null);console.log(error);});}else if(chat_id===null&&!chatid&&myUser!==null&&otherUser!==null){getChatData(userid).then(function(resp){return new Promise(function(res){return res(resp.data);});}).then(function(_ref4){var success=_ref4.success,error=_ref4.error;return new Promise(function(res,rej){if(success){res(success.data.map(function(v){return v.users.map(function(v){return v._id.toString()===myUser._id.toString()||v._id.toString()===otherUser._id.toString();}).filter(function(v){return v===true;}).length===2?v._id.toString():false;}).filter(function(v){return v!==false;}).join(''));}else{rej(error);}});}).then(function(cid){return cid.length===24&&setChatId(cid);});}},[chat_id,chatid,userid,myUser,otherUser]);useEffect(function(){var func=/*#__PURE__*/function(){var _ref5=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime().mark(function _callee(){return _regeneratorRuntime().wrap(function _callee$(_context){while(1)switch(_context.prev=_context.next){case 0:if(chat_id&&chat_id.length===24){// get the chat conversation data\ngetChatConversation(chat_id,myUser._id.toString()).then(function(resp){return new Promise(function(res){return res(resp.data);});}).then(function(_ref6){var success=_ref6.success;if(success&&chat_id===success.chatid.toString()){var newdata=success.data.reverse().map(function(v,i,dt){var isphotosnext=i<dt.length-1?dt[i+1].photos.length>0:false;var name=v.senderid.toString()===myUser._id.toString()?\"\".concat(myUser.firstname,\" \").concat(myUser.lastname):v.senderid.toString()===otherUser._id.toString()?\"\".concat(otherUser.firstname,\" \").concat(otherUser.lastname):'';var profilephoto=v.senderid.toString()===myUser._id.toString()?\"http://\".concat(window.location.hostname,\":\").concat(process.env.NODE_ENV==='development'?'3080':window.location.port).concat(myUser.photo):v.senderid.toString()===otherUser._id.toString()?\"http://\".concat(window.location.hostname,\":\").concat(process.env.NODE_ENV==='development'?'3080':'').concat(otherUser.photo):window.location.port;var previous=i<dt.length-1?v.senderid.toString()===dt[i+1].senderid.toString()&&(v.photos.length===0||!isphotosnext):false;var right=v.senderid.toString()===myUser._id.toString();return{name:name,profilephoto:profilephoto,previous:previous,right:right,message:v.message,time:new Date(v.timestamp),photos:_toConsumableArray(v.photos),onClick:handleOpenPhotos};}).reverse();if(newdata.length>data.length){console.log(\"?\");setData(newdata);// setTimeout(() => \n// scrollToBottom(), 100)\n}}else{throw new Error('Invalid chat data');}}).catch(function(error){setData([]);console.log(error);});}else{data.length>0&&setData([]);}// return setTimeout(func, 2000)\ncase 1:case\"end\":return _context.stop();}},_callee);}));return function func(){return _ref5.apply(this,arguments);};}();var interval=setInterval(func,1000);func();// clearInterval(interval)\nreturn function(){return clearInterval(interval);};},[chat_id,data.length]);// const scrollToBottom = () => {\n// messagesEnd.scrollIntoView({ behavior: \"smooth\", block: \"end\"});\n// }  \nreturn/*#__PURE__*/_jsx(_Fragment,{children:data.length>0?data.map(function(v,i){return/*#__PURE__*/_jsx(ChatMessageContent,_objectSpread({},v),\"convo_\".concat(chat_id,\"_\").concat(i));}):/*#__PURE__*/_jsx(\"div\",{className:\"chat-conversation\",children:/*#__PURE__*/_jsx(\"div\",{className:\"no-conversation\",children:\"No messages. Send a message to start chatting.\"})})});}","map":{"version":3,"names":["useState","useEffect","ChatMessageContent","getChatData","getChatConversation","getUserById","getUserByUsername","Swal","jsx","_jsx","Fragment","_Fragment","ChatConversation","_ref","chatid","userid","username","_useState","_useState2","_slicedToArray","chat_id","setChatId","_useState3","_useState4","data","setData","_useState5","_useState6","myUser","setMyUser","_useState7","_useState8","otherUser","setOtherUser","handleOpenPhotos","photo","i","photos","console","log","fire","width","height","background","html","concat","window","location","hostname","process","env","NODE_ENV","port","then","resp","Promise","res","rej","myuserinfo","catch","err","_ref2","success","error","filter","v","_id","toString","pop","chatdata","users","map","uid","Error","userinfo","_ref3","length","isValid","_ref4","join","cid","func","_ref5","_asyncToGenerator","_regeneratorRuntime","mark","_callee","wrap","_callee$","_context","prev","next","_ref6","newdata","reverse","dt","isphotosnext","name","senderid","firstname","lastname","profilephoto","previous","right","message","time","Date","timestamp","_toConsumableArray","onClick","stop","apply","arguments","interval","setInterval","clearInterval","children","_objectSpread","className"],"sources":["/workspaces/jchat/frontend/src/components/ChatConversation/ChatConversation.jsx"],"sourcesContent":["import { useState, useEffect } from 'react'\r\nimport ChatMessageContent from \"./ChatMessageContent\";\r\nimport { getChatData, getChatConversation, getUserById, getUserByUsername } from '../../api';\r\nimport Swal from 'sweetalert2'\r\n\r\nexport default function ChatConversation({ chatid, userid, username }) {\r\n  const [chat_id, setChatId] = useState(null)\r\n  const [data, setData] = useState([])\r\n  const [myUser, setMyUser] = useState(null)\r\n  const [otherUser, setOtherUser] = useState(null)\r\n  // const [messagesEnd, setMessagesEnd] = useState()\r\n\r\n  const handleOpenPhotos = (photo, i, photos) => {\r\n    console.log(photo, i, photos)\r\n    console.log(photos)\r\n    Swal.fire({\r\n      width: '100%',\r\n      height: '100%',\r\n      background: '#030821be',\r\n      html:`<img src=\"http://${window.location.hostname}:${process.env.NODE_ENV === 'development' ? '3080' : window.location.port}${photo}\" class=\"img-thumbnail img-fluid\" />`\r\n    })\r\n  }\r\n\r\n  useEffect(() => {\r\n    if (myUser === null && userid) {\r\n        getUserById(userid)\r\n        .then(resp => new Promise((res, rej)=>resp.data ? res(resp.data) : rej('Invalid chat data')))\r\n        .then((myuserinfo) => setMyUser(myuserinfo))\r\n        .catch(err => { setMyUser(null); console.log(err) })\r\n    }\r\n    if (otherUser === null && userid) {\r\n      if (chatid) {\r\n        getChatData(userid)\r\n        .then(resp => new Promise(res=>res(resp.data)))\r\n        .then(({success, error}) => new Promise((res, rej)=>\r\n          success ? res(success.data.filter(v => v._id.toString() === chatid).pop()) : rej(error)\r\n        ))\r\n        .then(chatdata =>\r\n          chatdata\r\n          ? getUserById(chatdata.users.map(v => v._id).filter(uid => uid !== userid).pop() || '')\r\n            .then(resp => new Promise(res=>res(resp.data)))\r\n          : (function(){throw new Error('Invalid chat data')})()\r\n        )\r\n        .then(userinfo => setOtherUser(userinfo))\r\n        .catch(err => { setOtherUser(null); console.log(err) })\r\n      } else if (username){\r\n        getUserByUsername(username)\r\n        .then(resp => new Promise(res => res(resp.data)))\r\n        .then(userinfo => setOtherUser(userinfo))\r\n        .catch(err => { setOtherUser(null); console.log(err) })\r\n      } else {\r\n        setOtherUser(null)\r\n      }\r\n    }\r\n  }, [chatid, userid, username, myUser, otherUser])\r\n\r\n  useEffect(() => {\r\n    if (chat_id === null && chatid && userid && myUser !== null && otherUser !== null) {\r\n      getChatData(userid)\r\n      .then(resp => new Promise(res=>res(resp.data)))\r\n      .then(({success, error}) => new Promise((res, rej)=> success\r\n        ? res(success.data.filter(v => v._id.toString() === chatid).length === 1)\r\n        : rej(error)\r\n      ))\r\n      .then(isValid => isValid ? setChatId(chatid) : setChatId(null))\r\n      .catch(error => { setChatId(null); console.log(error) } )\r\n    } else if (chat_id === null && !chatid && myUser !== null && otherUser !== null) {\r\n      getChatData(userid)\r\n      .then(resp => new Promise(res=>res(resp.data)))\r\n      .then(({success, error}) => new Promise((res, rej) => {\r\n        if (success) {\r\n          res(success.data.map(v =>\r\n            v.users\r\n            .map(v => v._id.toString() === myUser._id.toString() || v._id.toString() === otherUser._id.toString())\r\n            .filter(v => v === true).length === 2 ? v._id.toString() : false)\r\n          .filter(v => v !== false).join(''))\r\n        } else {\r\n          rej(error)\r\n        }\r\n      }))\r\n      .then(cid => cid.length === 24 && setChatId(cid))\r\n    }\r\n  }, [chat_id, chatid, userid, myUser, otherUser])\r\n\r\n  useEffect(() => {\r\n    const func = async () => {\r\n      if (chat_id && chat_id.length === 24) {\r\n        // get the chat conversation data\r\n        getChatConversation(chat_id, myUser._id.toString())\r\n        .then(resp => new Promise(res=>res(resp.data)))\r\n        .then(({success}) => {\r\n          if (success && chat_id === success.chatid.toString()) {\r\n            const newdata = success.data.reverse().map((v, i, dt) => {\r\n                const isphotosnext = i < dt.length - 1 ? dt[i+1].photos.length > 0 : false\r\n                const name = v.senderid.toString() === myUser._id.toString() ? `${myUser.firstname} ${myUser.lastname}` : (v.senderid.toString() === otherUser._id.toString() ? `${otherUser.firstname} ${otherUser.lastname}` : '')\r\n                const profilephoto = v.senderid.toString() === myUser._id.toString() ? `http://${window.location.hostname}:${process.env.NODE_ENV === 'development' ? '3080' : window.location.port}${myUser.photo}` : (v.senderid.toString() === otherUser._id.toString() ? `http://${window.location.hostname}:${process.env.NODE_ENV === 'development' ? '3080' : ''}${otherUser.photo}` : window.location.port)\r\n                const previous = i < dt.length - 1 ? v.senderid.toString() === dt[i+1].senderid.toString() && (v.photos.length === 0 || !isphotosnext) : false\r\n                const right = v.senderid.toString() === myUser._id.toString()\r\n                return {\r\n                  name,\r\n                  profilephoto,\r\n                  previous,\r\n                  right,\r\n                  message: v.message,\r\n                  time: new Date(v.timestamp),\r\n                  photos: [...v.photos],\r\n                  onClick: handleOpenPhotos,\r\n                }\r\n              }).reverse()\r\n              if (newdata.length > data.length) {\r\n                console.log(\"?\")\r\n                setData(newdata)\r\n                // setTimeout(() => \r\n                // scrollToBottom(), 100)\r\n              }\r\n          } else {\r\n            throw new Error('Invalid chat data')\r\n          }\r\n        })\r\n        .catch(error => { setData([]); console.log(error) })\r\n      } else {\r\n        data.length > 0 && setData([])\r\n      }\r\n      // return setTimeout(func, 2000)\r\n    }\r\n    const interval = setInterval(func, 1000)\r\n    func()\r\n    // clearInterval(interval)\r\n    return () => clearInterval(interval)\r\n  }, [chat_id, data.length])\r\n\r\n  // const scrollToBottom = () => {\r\n    // messagesEnd.scrollIntoView({ behavior: \"smooth\", block: \"end\"});\r\n  // }  \r\n\r\n  return (<>\r\n  {/* <div className=\"container-fluid overflow-auto d-flex flex-column-reverse\" style={{minHeight: '100%', float:\"left\", clear: \"both\" }} ref={setMessagesEnd}> */}\r\n    { data.length > 0\r\n      ? data.map((v, i) => <ChatMessageContent key={`convo_${chat_id}_${i}`} {...v} />)\r\n      : <div className=\"chat-conversation\">\r\n          <div className=\"no-conversation\">No messages. Send a message to start chatting.</div>\r\n        </div> }\r\n  {/* </div> */}\r\n  </>);\r\n}"],"mappings":"ukBAAA,OAASA,QAAQ,CAAEC,SAAS,KAAQ,OAAO,CAC3C,MAAO,CAAAC,kBAAkB,KAAM,sBAAsB,CACrD,OAASC,WAAW,CAAEC,mBAAmB,CAAEC,WAAW,CAAEC,iBAAiB,KAAQ,WAAW,CAC5F,MAAO,CAAAC,IAAI,KAAM,aAAa,QAAAC,GAAA,IAAAC,IAAA,gCAAAC,QAAA,IAAAC,SAAA,yBAE9B,cAAe,SAAS,CAAAC,gBAAgBA,CAAAC,IAAA,CAA+B,IAA5B,CAAAC,MAAM,CAAAD,IAAA,CAANC,MAAM,CAAEC,MAAM,CAAAF,IAAA,CAANE,MAAM,CAAEC,QAAQ,CAAAH,IAAA,CAARG,QAAQ,CACjE,IAAAC,SAAA,CAA6BjB,QAAQ,CAAC,IAAI,CAAC,CAAAkB,UAAA,CAAAC,cAAA,CAAAF,SAAA,IAApCG,OAAO,CAAAF,UAAA,IAAEG,SAAS,CAAAH,UAAA,IACzB,IAAAI,UAAA,CAAwBtB,QAAQ,CAAC,EAAE,CAAC,CAAAuB,UAAA,CAAAJ,cAAA,CAAAG,UAAA,IAA7BE,IAAI,CAAAD,UAAA,IAAEE,OAAO,CAAAF,UAAA,IACpB,IAAAG,UAAA,CAA4B1B,QAAQ,CAAC,IAAI,CAAC,CAAA2B,UAAA,CAAAR,cAAA,CAAAO,UAAA,IAAnCE,MAAM,CAAAD,UAAA,IAAEE,SAAS,CAAAF,UAAA,IACxB,IAAAG,UAAA,CAAkC9B,QAAQ,CAAC,IAAI,CAAC,CAAA+B,UAAA,CAAAZ,cAAA,CAAAW,UAAA,IAAzCE,SAAS,CAAAD,UAAA,IAAEE,YAAY,CAAAF,UAAA,IAC9B;AAEA,GAAM,CAAAG,gBAAgB,CAAG,QAAnB,CAAAA,gBAAgBA,CAAIC,KAAK,CAAEC,CAAC,CAAEC,MAAM,CAAK,CAC7CC,OAAO,CAACC,GAAG,CAACJ,KAAK,CAAEC,CAAC,CAAEC,MAAM,CAAC,CAC7BC,OAAO,CAACC,GAAG,CAACF,MAAM,CAAC,CACnB9B,IAAI,CAACiC,IAAI,CAAC,CACRC,KAAK,CAAE,MAAM,CACbC,MAAM,CAAE,MAAM,CACdC,UAAU,CAAE,WAAW,CACvBC,IAAI,sBAAAC,MAAA,CAAqBC,MAAM,CAACC,QAAQ,CAACC,QAAQ,MAAAH,MAAA,CAAII,OAAO,CAACC,GAAG,CAACC,QAAQ,GAAK,aAAa,CAAG,MAAM,CAAGL,MAAM,CAACC,QAAQ,CAACK,IAAI,EAAAP,MAAA,CAAGV,KAAK,2CACrI,CAAC,CAAC,CACJ,CAAC,CAEDlC,SAAS,CAAC,UAAM,CACd,GAAI2B,MAAM,GAAK,IAAI,EAAIb,MAAM,CAAE,CAC3BV,WAAW,CAACU,MAAM,CAAC,CAClBsC,IAAI,CAAC,SAAAC,IAAI,QAAI,IAAI,CAAAC,OAAO,CAAC,SAACC,GAAG,CAAEC,GAAG,QAAG,CAAAH,IAAI,CAAC9B,IAAI,CAAGgC,GAAG,CAACF,IAAI,CAAC9B,IAAI,CAAC,CAAGiC,GAAG,CAAC,mBAAmB,CAAC,GAAC,GAAC,CAC5FJ,IAAI,CAAC,SAACK,UAAU,QAAK,CAAA7B,SAAS,CAAC6B,UAAU,CAAC,GAAC,CAC3CC,KAAK,CAAC,SAAAC,GAAG,CAAI,CAAE/B,SAAS,CAAC,IAAI,CAAC,CAAES,OAAO,CAACC,GAAG,CAACqB,GAAG,CAAC,CAAC,CAAC,CAAC,CACxD,CACA,GAAI5B,SAAS,GAAK,IAAI,EAAIjB,MAAM,CAAE,CAChC,GAAID,MAAM,CAAE,CACVX,WAAW,CAACY,MAAM,CAAC,CAClBsC,IAAI,CAAC,SAAAC,IAAI,QAAI,IAAI,CAAAC,OAAO,CAAC,SAAAC,GAAG,QAAE,CAAAA,GAAG,CAACF,IAAI,CAAC9B,IAAI,CAAC,GAAC,GAAC,CAC9C6B,IAAI,CAAC,SAAAQ,KAAA,KAAE,CAAAC,OAAO,CAAAD,KAAA,CAAPC,OAAO,CAAEC,KAAK,CAAAF,KAAA,CAALE,KAAK,OAAM,IAAI,CAAAR,OAAO,CAAC,SAACC,GAAG,CAAEC,GAAG,QAC/C,CAAAK,OAAO,CAAGN,GAAG,CAACM,OAAO,CAACtC,IAAI,CAACwC,MAAM,CAAC,SAAAC,CAAC,QAAI,CAAAA,CAAC,CAACC,GAAG,CAACC,QAAQ,CAAC,CAAC,GAAKrD,MAAM,GAAC,CAACsD,GAAG,CAAC,CAAC,CAAC,CAAGX,GAAG,CAACM,KAAK,CAAC,EACzF,CAAC,GAAC,CACDV,IAAI,CAAC,SAAAgB,QAAQ,QACZ,CAAAA,QAAQ,CACNhE,WAAW,CAACgE,QAAQ,CAACC,KAAK,CAACC,GAAG,CAAC,SAAAN,CAAC,QAAI,CAAAA,CAAC,CAACC,GAAG,GAAC,CAACF,MAAM,CAAC,SAAAQ,GAAG,QAAI,CAAAA,GAAG,GAAKzD,MAAM,GAAC,CAACqD,GAAG,CAAC,CAAC,EAAI,EAAE,CAAC,CACpFf,IAAI,CAAC,SAAAC,IAAI,QAAI,IAAI,CAAAC,OAAO,CAAC,SAAAC,GAAG,QAAE,CAAAA,GAAG,CAACF,IAAI,CAAC9B,IAAI,CAAC,GAAC,GAAC,CAC9C,UAAU,CAAC,KAAM,IAAI,CAAAiD,KAAK,CAAC,mBAAmB,CAAC,EAAC,CAAE,CAAC,EACxD,CAAC,CACApB,IAAI,CAAC,SAAAqB,QAAQ,QAAI,CAAAzC,YAAY,CAACyC,QAAQ,CAAC,GAAC,CACxCf,KAAK,CAAC,SAAAC,GAAG,CAAI,CAAE3B,YAAY,CAAC,IAAI,CAAC,CAAEK,OAAO,CAACC,GAAG,CAACqB,GAAG,CAAC,CAAC,CAAC,CAAC,CACzD,CAAC,IAAM,IAAI5C,QAAQ,CAAC,CAClBV,iBAAiB,CAACU,QAAQ,CAAC,CAC1BqC,IAAI,CAAC,SAAAC,IAAI,QAAI,IAAI,CAAAC,OAAO,CAAC,SAAAC,GAAG,QAAI,CAAAA,GAAG,CAACF,IAAI,CAAC9B,IAAI,CAAC,GAAC,GAAC,CAChD6B,IAAI,CAAC,SAAAqB,QAAQ,QAAI,CAAAzC,YAAY,CAACyC,QAAQ,CAAC,GAAC,CACxCf,KAAK,CAAC,SAAAC,GAAG,CAAI,CAAE3B,YAAY,CAAC,IAAI,CAAC,CAAEK,OAAO,CAACC,GAAG,CAACqB,GAAG,CAAC,CAAC,CAAC,CAAC,CACzD,CAAC,IAAM,CACL3B,YAAY,CAAC,IAAI,CAAC,CACpB,CACF,CACF,CAAC,CAAE,CAACnB,MAAM,CAAEC,MAAM,CAAEC,QAAQ,CAAEY,MAAM,CAAEI,SAAS,CAAC,CAAC,CAEjD/B,SAAS,CAAC,UAAM,CACd,GAAImB,OAAO,GAAK,IAAI,EAAIN,MAAM,EAAIC,MAAM,EAAIa,MAAM,GAAK,IAAI,EAAII,SAAS,GAAK,IAAI,CAAE,CACjF7B,WAAW,CAACY,MAAM,CAAC,CAClBsC,IAAI,CAAC,SAAAC,IAAI,QAAI,IAAI,CAAAC,OAAO,CAAC,SAAAC,GAAG,QAAE,CAAAA,GAAG,CAACF,IAAI,CAAC9B,IAAI,CAAC,GAAC,GAAC,CAC9C6B,IAAI,CAAC,SAAAsB,KAAA,KAAE,CAAAb,OAAO,CAAAa,KAAA,CAAPb,OAAO,CAAEC,KAAK,CAAAY,KAAA,CAALZ,KAAK,OAAM,IAAI,CAAAR,OAAO,CAAC,SAACC,GAAG,CAAEC,GAAG,QAAI,CAAAK,OAAO,CACxDN,GAAG,CAACM,OAAO,CAACtC,IAAI,CAACwC,MAAM,CAAC,SAAAC,CAAC,QAAI,CAAAA,CAAC,CAACC,GAAG,CAACC,QAAQ,CAAC,CAAC,GAAKrD,MAAM,GAAC,CAAC8D,MAAM,GAAK,CAAC,CAAC,CACvEnB,GAAG,CAACM,KAAK,CAAC,EACd,CAAC,GAAC,CACDV,IAAI,CAAC,SAAAwB,OAAO,QAAI,CAAAA,OAAO,CAAGxD,SAAS,CAACP,MAAM,CAAC,CAAGO,SAAS,CAAC,IAAI,CAAC,GAAC,CAC9DsC,KAAK,CAAC,SAAAI,KAAK,CAAI,CAAE1C,SAAS,CAAC,IAAI,CAAC,CAAEiB,OAAO,CAACC,GAAG,CAACwB,KAAK,CAAC,CAAC,CAAE,CAAC,CAC3D,CAAC,IAAM,IAAI3C,OAAO,GAAK,IAAI,EAAI,CAACN,MAAM,EAAIc,MAAM,GAAK,IAAI,EAAII,SAAS,GAAK,IAAI,CAAE,CAC/E7B,WAAW,CAACY,MAAM,CAAC,CAClBsC,IAAI,CAAC,SAAAC,IAAI,QAAI,IAAI,CAAAC,OAAO,CAAC,SAAAC,GAAG,QAAE,CAAAA,GAAG,CAACF,IAAI,CAAC9B,IAAI,CAAC,GAAC,GAAC,CAC9C6B,IAAI,CAAC,SAAAyB,KAAA,KAAE,CAAAhB,OAAO,CAAAgB,KAAA,CAAPhB,OAAO,CAAEC,KAAK,CAAAe,KAAA,CAALf,KAAK,OAAM,IAAI,CAAAR,OAAO,CAAC,SAACC,GAAG,CAAEC,GAAG,CAAK,CACpD,GAAIK,OAAO,CAAE,CACXN,GAAG,CAACM,OAAO,CAACtC,IAAI,CAAC+C,GAAG,CAAC,SAAAN,CAAC,QACpB,CAAAA,CAAC,CAACK,KAAK,CACNC,GAAG,CAAC,SAAAN,CAAC,QAAI,CAAAA,CAAC,CAACC,GAAG,CAACC,QAAQ,CAAC,CAAC,GAAKvC,MAAM,CAACsC,GAAG,CAACC,QAAQ,CAAC,CAAC,EAAIF,CAAC,CAACC,GAAG,CAACC,QAAQ,CAAC,CAAC,GAAKnC,SAAS,CAACkC,GAAG,CAACC,QAAQ,CAAC,CAAC,GAAC,CACrGH,MAAM,CAAC,SAAAC,CAAC,QAAI,CAAAA,CAAC,GAAK,IAAI,GAAC,CAACW,MAAM,GAAK,CAAC,CAAGX,CAAC,CAACC,GAAG,CAACC,QAAQ,CAAC,CAAC,CAAG,KAAK,GAAC,CAClEH,MAAM,CAAC,SAAAC,CAAC,QAAI,CAAAA,CAAC,GAAK,KAAK,GAAC,CAACc,IAAI,CAAC,EAAE,CAAC,CAAC,CACrC,CAAC,IAAM,CACLtB,GAAG,CAACM,KAAK,CAAC,CACZ,CACF,CAAC,CAAC,GAAC,CACFV,IAAI,CAAC,SAAA2B,GAAG,QAAI,CAAAA,GAAG,CAACJ,MAAM,GAAK,EAAE,EAAIvD,SAAS,CAAC2D,GAAG,CAAC,GAAC,CACnD,CACF,CAAC,CAAE,CAAC5D,OAAO,CAAEN,MAAM,CAAEC,MAAM,CAAEa,MAAM,CAAEI,SAAS,CAAC,CAAC,CAEhD/B,SAAS,CAAC,UAAM,CACd,GAAM,CAAAgF,IAAI,6BAAAC,KAAA,CAAAC,iBAAA,cAAAC,mBAAA,GAAAC,IAAA,CAAG,SAAAC,QAAA,SAAAF,mBAAA,GAAAG,IAAA,UAAAC,SAAAC,QAAA,iBAAAA,QAAA,CAAAC,IAAA,CAAAD,QAAA,CAAAE,IAAA,SACX,GAAIvE,OAAO,EAAIA,OAAO,CAACwD,MAAM,GAAK,EAAE,CAAE,CACpC;AACAxE,mBAAmB,CAACgB,OAAO,CAAEQ,MAAM,CAACsC,GAAG,CAACC,QAAQ,CAAC,CAAC,CAAC,CAClDd,IAAI,CAAC,SAAAC,IAAI,QAAI,IAAI,CAAAC,OAAO,CAAC,SAAAC,GAAG,QAAE,CAAAA,GAAG,CAACF,IAAI,CAAC9B,IAAI,CAAC,GAAC,GAAC,CAC9C6B,IAAI,CAAC,SAAAuC,KAAA,CAAe,IAAb,CAAA9B,OAAO,CAAA8B,KAAA,CAAP9B,OAAO,CACb,GAAIA,OAAO,EAAI1C,OAAO,GAAK0C,OAAO,CAAChD,MAAM,CAACqD,QAAQ,CAAC,CAAC,CAAE,CACpD,GAAM,CAAA0B,OAAO,CAAG/B,OAAO,CAACtC,IAAI,CAACsE,OAAO,CAAC,CAAC,CAACvB,GAAG,CAAC,SAACN,CAAC,CAAE7B,CAAC,CAAE2D,EAAE,CAAK,CACrD,GAAM,CAAAC,YAAY,CAAG5D,CAAC,CAAG2D,EAAE,CAACnB,MAAM,CAAG,CAAC,CAAGmB,EAAE,CAAC3D,CAAC,CAAC,CAAC,CAAC,CAACC,MAAM,CAACuC,MAAM,CAAG,CAAC,CAAG,KAAK,CAC1E,GAAM,CAAAqB,IAAI,CAAGhC,CAAC,CAACiC,QAAQ,CAAC/B,QAAQ,CAAC,CAAC,GAAKvC,MAAM,CAACsC,GAAG,CAACC,QAAQ,CAAC,CAAC,IAAAtB,MAAA,CAAMjB,MAAM,CAACuE,SAAS,MAAAtD,MAAA,CAAIjB,MAAM,CAACwE,QAAQ,EAAMnC,CAAC,CAACiC,QAAQ,CAAC/B,QAAQ,CAAC,CAAC,GAAKnC,SAAS,CAACkC,GAAG,CAACC,QAAQ,CAAC,CAAC,IAAAtB,MAAA,CAAMb,SAAS,CAACmE,SAAS,MAAAtD,MAAA,CAAIb,SAAS,CAACoE,QAAQ,EAAK,EAAG,CACpN,GAAM,CAAAC,YAAY,CAAGpC,CAAC,CAACiC,QAAQ,CAAC/B,QAAQ,CAAC,CAAC,GAAKvC,MAAM,CAACsC,GAAG,CAACC,QAAQ,CAAC,CAAC,WAAAtB,MAAA,CAAaC,MAAM,CAACC,QAAQ,CAACC,QAAQ,MAAAH,MAAA,CAAII,OAAO,CAACC,GAAG,CAACC,QAAQ,GAAK,aAAa,CAAG,MAAM,CAAGL,MAAM,CAACC,QAAQ,CAACK,IAAI,EAAAP,MAAA,CAAGjB,MAAM,CAACO,KAAK,EAAM8B,CAAC,CAACiC,QAAQ,CAAC/B,QAAQ,CAAC,CAAC,GAAKnC,SAAS,CAACkC,GAAG,CAACC,QAAQ,CAAC,CAAC,WAAAtB,MAAA,CAAaC,MAAM,CAACC,QAAQ,CAACC,QAAQ,MAAAH,MAAA,CAAII,OAAO,CAACC,GAAG,CAACC,QAAQ,GAAK,aAAa,CAAG,MAAM,CAAG,EAAE,EAAAN,MAAA,CAAGb,SAAS,CAACG,KAAK,EAAKW,MAAM,CAACC,QAAQ,CAACK,IAAK,CACnY,GAAM,CAAAkD,QAAQ,CAAGlE,CAAC,CAAG2D,EAAE,CAACnB,MAAM,CAAG,CAAC,CAAGX,CAAC,CAACiC,QAAQ,CAAC/B,QAAQ,CAAC,CAAC,GAAK4B,EAAE,CAAC3D,CAAC,CAAC,CAAC,CAAC,CAAC8D,QAAQ,CAAC/B,QAAQ,CAAC,CAAC,GAAKF,CAAC,CAAC5B,MAAM,CAACuC,MAAM,GAAK,CAAC,EAAI,CAACoB,YAAY,CAAC,CAAG,KAAK,CAC9I,GAAM,CAAAO,KAAK,CAAGtC,CAAC,CAACiC,QAAQ,CAAC/B,QAAQ,CAAC,CAAC,GAAKvC,MAAM,CAACsC,GAAG,CAACC,QAAQ,CAAC,CAAC,CAC7D,MAAO,CACL8B,IAAI,CAAJA,IAAI,CACJI,YAAY,CAAZA,YAAY,CACZC,QAAQ,CAARA,QAAQ,CACRC,KAAK,CAALA,KAAK,CACLC,OAAO,CAAEvC,CAAC,CAACuC,OAAO,CAClBC,IAAI,CAAE,GAAI,CAAAC,IAAI,CAACzC,CAAC,CAAC0C,SAAS,CAAC,CAC3BtE,MAAM,CAAAuE,kBAAA,CAAM3C,CAAC,CAAC5B,MAAM,CAAC,CACrBwE,OAAO,CAAE3E,gBACX,CAAC,CACH,CAAC,CAAC,CAAC4D,OAAO,CAAC,CAAC,CACZ,GAAID,OAAO,CAACjB,MAAM,CAAGpD,IAAI,CAACoD,MAAM,CAAE,CAChCtC,OAAO,CAACC,GAAG,CAAC,GAAG,CAAC,CAChBd,OAAO,CAACoE,OAAO,CAAC,CAChB;AACA;AACF,CACJ,CAAC,IAAM,CACL,KAAM,IAAI,CAAApB,KAAK,CAAC,mBAAmB,CAAC,CACtC,CACF,CAAC,CAAC,CACDd,KAAK,CAAC,SAAAI,KAAK,CAAI,CAAEtC,OAAO,CAAC,EAAE,CAAC,CAAEa,OAAO,CAACC,GAAG,CAACwB,KAAK,CAAC,CAAC,CAAC,CAAC,CACtD,CAAC,IAAM,CACLvC,IAAI,CAACoD,MAAM,CAAG,CAAC,EAAInD,OAAO,CAAC,EAAE,CAAC,CAChC,CACA;AAAA,wBAAAgE,QAAA,CAAAqB,IAAA,MAAAxB,OAAA,GACD,kBAvCK,CAAAL,IAAIA,CAAA,SAAAC,KAAA,CAAA6B,KAAA,MAAAC,SAAA,OAuCT,CACD,GAAM,CAAAC,QAAQ,CAAGC,WAAW,CAACjC,IAAI,CAAE,IAAI,CAAC,CACxCA,IAAI,CAAC,CAAC,CACN;AACA,MAAO,kBAAM,CAAAkC,aAAa,CAACF,QAAQ,CAAC,GACtC,CAAC,CAAE,CAAC7F,OAAO,CAAEI,IAAI,CAACoD,MAAM,CAAC,CAAC,CAE1B;AACE;AACF;AAEA,mBAAQnE,IAAA,CAAAE,SAAA,EAAAyG,QAAA,CAEJ5F,IAAI,CAACoD,MAAM,CAAG,CAAC,CACbpD,IAAI,CAAC+C,GAAG,CAAC,SAACN,CAAC,CAAE7B,CAAC,qBAAK3B,IAAA,CAACP,kBAAkB,CAAAmH,aAAA,IAAmCpD,CAAC,WAAApB,MAAA,CAArBzB,OAAO,MAAAyB,MAAA,CAAIT,CAAC,CAAY,CAAC,GAAC,cAC/E3B,IAAA,QAAK6G,SAAS,CAAC,mBAAmB,CAAAF,QAAA,cAChC3G,IAAA,QAAK6G,SAAS,CAAC,iBAAiB,CAAAF,QAAA,CAAC,gDAA8C,CAAK,CAAC,CAClF,CAAC,CAEV,CAAC,CACL"},"metadata":{},"sourceType":"module","externalDependencies":[]}